<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Happy Birthday, Surbala!</title>
    <style>
        body {
            background: linear-gradient(45deg, #ffe6cc, #ffccff, #cce6ff, #ffebcc);
            background-size: 400%;
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 20px;
            overflow: hidden;
            position: relative;
            animation: gradientShift 15s ease infinite;
        }
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, transparent 50%, rgba(0, 0, 0, 0.3) 100%);
            pointer-events: none;
            z-index: 1;
        }
        body::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAABJJREFUKFNjZGT8//8/AzMwMgaBlwEAaNAh/QAAAABJRU5ErkJggg==') repeat;
            opacity: 0.1;
            pointer-events: none;
            z-index: 1;
        }
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .intro-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
            color: white;
            font-size: 24px;
        }
        .intro-overlay.hidden {
            display: none;
        }
        .star-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: black;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9;
            color: #ffd700;
            font-size: 32px;
            font-weight: bold;
            display: none;
        }
        .star-overlay.show {
            display: flex;
        }
        .star-overlay span {
            opacity: 0;
            animation: starReveal 3s forwards;
        }
        @keyframes starReveal {
            0% { opacity: 0; transform: scale(0.5); }
            30% { opacity: 1; transform: scale(1); }
            70% { opacity: 1; transform: scale(1.2); }
            100% { opacity: 0; transform: scale(0.5); }
        }
        .final-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: black;
            display: none;
            z-index: 8;
            opacity: 0;
            transition: opacity 2s ease;
        }
        .final-overlay.show {
            display: flex;
            opacity: 1;
        }
        .stars {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
        }
        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: #fff;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }
        @keyframes twinkle {
            0%, 100% { opacity: 0.2; }
            50% { opacity: 1; }
        }
        .sky-sparkle {
            position: absolute;
            font-size: 24px;
            z-index: 1;
            animation: twinkle 2s infinite;
        }
        .sky-sparkle.left {
            top: 10px;
            left: 10px;
        }
        .sky-sparkle.right {
            top: 10px;
            right: 10px;
        }
        .hearts {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
        }
        .heart {
            position: absolute;
            font-size: 20px;
            color: #ff99cc;
            opacity: 0.5;
            animation: floatHeart 8s infinite linear;
        }
        @keyframes floatHeart {
            0% { transform: translateY(100vh); opacity: 0.5; }
            100% { transform: translateY(-20vh); opacity: 0; }
        }
        .banner {
            font-size: 36px;
            margin: 20px 0;
            position: relative;
            z-index: 2;
            font-weight: bold;
        }
        .banner span {
            display: inline-block;
            color: #cc3366;
            padding: 10px;
            margin: 0 5px;
            opacity: 0;
            animation: revealLetter 0.5s forwards;
        }
        @keyframes revealLetter {
            0% { opacity: 0; transform: scale(0.5) rotate(-15deg); }
            100% { opacity: 1; transform: scale(1) rotate(0deg); }
        }
        .banner span:nth-child(1) { animation-delay: 0.1s; }
        .banner span:nth-child(2) { animation-delay: 0.2s; }
        .banner span:nth-child(3) { animation-delay: 0.3s; }
        .banner span:nth-child(4) { animation-delay: 0.4s; }
        .banner span:nth-child(5) { animation-delay: 0.5s; }
        .banner span:nth-child(6) { animation-delay: 0.6s; }
        .banner span:nth-child(7) { animation-delay: 0.7s; }
        .banner span:nth-child(8) { animation-delay: 0.8s; }
        .banner span:nth-child(9) { animation-delay: 0.9s; }
        .banner span:nth-child(10) { animation-delay: 1.0s; }
        .banner span:nth-child(11) { animation-delay: 1.1s; }
        .banner span:nth-child(12) { animation-delay: 1.2s; }
        .banner span:nth-child(13) { animation-delay: 1.3s; }
        .star-message {
            font-size: 28px;
            color: #3366cc;
            margin: 20px 0;
            position: relative;
            z-index: 2;
            opacity: 0;
            animation: fadeIn 1s forwards;
            animation-delay: 0.5s;
            font-weight: bold;
        }
        @keyframes fadeIn {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }
        .lights {
            display: flex;
            justify-content: center;
            margin: 20px 0;
            position: relative;
            z-index: 2;
        }
        .lights div {
            width: 20px;
            height: 20px;
            background-color: #ffcc66;
            border-radius: 50%;
            margin: 0 10px;
            box-shadow: 0 0 15px #ffcc66;
            animation: glow 2s infinite;
        }
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 15px #ffcc66; }
            50% { box-shadow: 0 0 30px #ffcc66; }
        }
        .balloons {
            display: flex;
            justify-content: center;
            margin: 20px 0;
            position: relative;
            z-index: 2;
        }
        .balloon {
            width: 70px;
            height: 90px;
            background: linear-gradient(
                45deg,
                rgba(255, 102, 102, 0.9) 0%,
                rgba(255, 150, 150, 0.7) 30%,
                rgba(255, 204, 204, 0.5) 70%,
                rgba(255, 255, 255, 0.3) 100%
            );
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAAXNSR0IArs4c6QAAABJJREFUKFNjZGT8z8DAwMCAgQ0A4g8G/QAAAABJRU5ErkJggg==');
            background-blend-mode: overlay;
            border-radius: 50% 50% 50% 50% / 70% 70% 30% 30%;
            border: 2px solid rgba(255, 255, 255, 0.8);
            margin: 0 10px;
            position: relative;
            color: white;
            font-size: 30px;
            font-weight: bold;
            line-height: 90px;
            cursor: pointer;
            opacity: 0;
            animation: flyIn 1s forwards, float 3s infinite ease-in-out, sway 5s infinite ease-in-out, glow 2s infinite;
            transition: transform: 0.3s;
            box-shadow: 8px 8px 20px rgba(0, 0, 0, 0.4), inset -8px -8px 15px rgba(0, 0, 0, 0.3), inset 8px 8px 15px rgba(255, 255, 255, 0.6);
            z-index: 2;
            touch-action: manipulation;
            user-select: none;
        }
        .balloon::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 20%, rgba(255, 255, 255, 0.9), transparent 40%);
            border-radius: 50% 50% 50% 50% / 70% 70% 30% 30%;
            animation: shimmer 1.5s infinite;
            z-index: 1;
        }
        .balloon::after {
            content: '';
            width: 2px;
            height: 60px;
            background-color: #555;
            position: absolute;
            bottom: -60px;
            left: 34px;
            z-index: 0;
        }
        .balloon span {
            position: relative;
            z-index: 2;
        }
        .balloon:nth-child(1) { animation-delay: 0s, 0s, 0s, 0s; background: linear-gradient(45deg, rgba(255, 102, 102, 0.9) 0%, rgba(255, 150, 150, 0.7) 30%, rgba(255, 204, 204, 0.5) 70%, rgba(255, 255, 255, 0.3) 100%); box-shadow: 8px 8px 20px rgba(0, 0, 0, 0.4), inset -8px -8px 15px rgba(0, 0, 0, 0.3), inset 8px 8px 15px rgba(255, 255, 255, 0.6); }
        .balloon:nth-child(2) { animation-delay: 0.5s, 0.2s, 0.2s, 0.2s; background: linear-gradient(45deg, rgba(102, 204, 102, 0.9) 0%, rgba(150, 255, 150, 0.7) 30%, rgba(204, 255, 204, 0.5) 70%, rgba(255, 255, 255, 0.3) 100%); box-shadow: 8px 8px 20px rgba(0, 0, 0, 0.4), inset -8px -8px 15px rgba(0, 0, 0, 0.3), inset 8px 8px 15px rgba(255, 255, 255, 0.6); }
        .balloon:nth-child(3) { animation-delay: 1.0s, 0.4s, 0.4s, 0.4s; background: linear-gradient(45deg, rgba(102, 102, 255, 0.9) 0%, rgba(150, 150, 255, 0.7) 30%, rgba(204, 204, 255, 0.5) 70%, rgba(255, 255, 255, 0.3) 100%); box-shadow: 8px 8px 20px rgba(0, 0, 0, 0.4), inset -8px -8px 15px rgba(0, 0, 0, 0.3), inset 8px 8px 15px rgba(255, 255, 255, 0.6); }
        .balloon:nth-child(4) { animation-delay: 1.5s, 0.6s, 0.6s, 0.6s; background: linear-gradient(45deg, rgba(255, 204, 102, 0.9) 0%, rgba(255, 230, 150, 0.7) 30%, rgba(255, 255, 204, 0.5) 70%, rgba(255, 255, 255, 0.3) 100%); box-shadow: 8px 8px 20px rgba(0, 0, 0, 0.4), inset -8px -8px 15px rgba(0, 0, 0, 0.3), inset 8px 8px 15px rgba(255, 255, 255, 0.6); }
        .balloon:nth-child(5) { animation-delay: 2.0s, 0.8s, 0.8s, 0.8s; background: linear-gradient(45deg, rgba(255, 153, 204, 0.9) 0%, rgba(255, 180, 220, 0.7) 30%, rgba(255, 229, 255, 0.5) 70%, rgba(255, 255, 255, 0.3) 100%); box-shadow: 8px 8px 20px rgba(0, 0, 0, 0.4), inset -8px -8px 15px rgba(0, 0, 0, 0.3), inset 8px 8px 15px rgba(255, 255, 255, 0.6); }
        .balloon:nth-child(6) { animation-delay: 2.5s, 1.0s, 1.0s, 1.0s; background: linear-gradient(45deg, rgba(204, 102, 204, 0.9) 0%, rgba(230, 150, 230, 0.7) 30%, rgba(255, 204, 255, 0.5) 70%, rgba(255, 255, 255, 0.3) 100%); box-shadow: 8px 8px 20px rgba(0, 0, 0, 0.4), inset -8px -8px 15px rgba(0, 0, 0, 0.3), inset 8px 8px 15px rgba(255, 255, 255, 0.6); }
        .balloon:nth-child(7) { animation-delay: 3.0s, 1.2s, 1.2s, 1.2s; background: linear-gradient(45deg, rgba(102, 204, 255, 0.9) 0%, rgba(150, 230, 255, 0.7) 30%, rgba(204, 255, 255, 0.5) 70%, rgba(255, 255, 255, 0.3) 100%); box-shadow: 8px 8px 20px rgba(0, 0, 0, 0.4), inset -8px -8px 15px rgba(0, 0, 0, 0.3), inset 8px 8px 15px rgba(255, 255, 255, 0.6); }
        @keyframes flyIn {
            0% { transform: translateY(100vh); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }
        @keyframes sway {
            0%, 100% { transform: rotate(5deg); }
            50% { transform: rotate(-5deg); }
        }
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        .balloon.popped {
            transform: scale(0);
            transition: transform 0.3s;
        }
        .burst {
            position: absolute;
            width: 5px;
            height: 5px;
            background: #ffcc66;
            border-radius: 50%;
            animation: burst 0.5s forwards;
            z-index: 2;
        }
        @keyframes burst {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(3); opacity: 0; }
        }
        .sparkle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: radial-gradient(circle, #ffcc66, transparent);
            border-radius: 50%;
            animation: sparkle 1s infinite;
            z-index: 1;
            pointer-events: none;
        }
        @keyframes sparkle {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.3; transform: scale(1.5); }
        }
        .dance-cat {
            position: absolute;
            font-size: 40px;
            z-index: 2;
            display: none;
            animation: dance 2s infinite;
        }
        .dance-cat.show {
            display: block;
        }
        .dance-cat:nth-child(1) { left: 10%; top: 70%; animation-delay: 0s; }
        .dance-cat:nth-child(2) { left: 25%; top: 75%; animation-delay: 0.5s; }
        .dance-cat:nth-child(3) { right: 10%; top: 70%; animation-delay: 0.3s; }
        @keyframes dance {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(15deg); }
            75% { transform: rotate(-15deg); }
        }
        .falling-cat {
            position: absolute;
            font-size: 40px;
            z-index: 2;
            display: none;
            animation: fall 3s linear forwards;
        }
        .falling-cat.show {
            display: block;
        }
        .falling-cat:nth-child(4) { left: 20%; animation-delay: 0s; }
        .falling-cat:nth-child(5) { left: 40%; animation-delay: 0.5s; } /* Moved from 50% to 40% */
        .falling-cat:nth-child(6) { left: 80%; animation-delay: 1s; }
        @keyframes fall {
            0% { top: -10%; opacity: 1; transform: rotate(0deg); }
            100% { top: 100%; opacity: 0.5; transform: rotate(360deg); }
        }
        .message {
            font-size: 28px;
            color: #3366cc;
            margin-top: 30px;
            display: none;
            position: relative;
            z-index: 2;
            font-weight: bold;
        }
        .message.show {
            display: block;
        }
        .hidden-message {
            font-size: 24px;
            color: #cc3366;
            margin-top: 20px;
            display: none;
            position: relative;
            z-index: 2;
            white-space: pre-wrap;
            max-height: 150px;
            overflow-y: auto;
            font-weight: bold;
        }
        .hidden-message.show {
            display: block;
        }
        .final-message {
            font-size: 24px;
            color: #3366cc;
            margin-top: 20px;
            display: none;
            position: relative;
            z-index: 2;
            max-height: 100px;
            overflow-y: auto;
            font-weight: bold;
        }
        .final-message.show {
            display: block;
        }
        .wishing {
            font-size: 28px;
            color: #3366cc;
            margin-top: 20px;
            display: none;
            animation: glow 2s infinite;
            position: relative;
            z-index: 2;
            font-weight: bold;
        }
        .wishing.show {
            display: block;
        }
        .enjoy-message {
            font-size: 32px;
            color: #cc3366;
            margin-top: 20px;
            display: none;
            position: relative;
            z-index: 2;
            animation: fadeIn 1s forwards;
            font-weight: bold;
        }
        .enjoy-message.show {
            display: block;
        }
        .cake-container {
            margin-top: 20px;
            display: none;
            position: relative;
            z-index: 9;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .cake-container.show {
            display: flex;
            opacity: 0;
            animation: fadeInCake 1s forwards;
        }
        @keyframes fadeInCake {
            0% { opacity: 0; transform: scale(0.8); }
            100% { opacity: 1; transform: scale(1); }
        }
        .cake {
            font-size: 120px;
            animation: flicker 0.5s infinite;
        }
        .cake.cut {
            animation: cutCake 1s forwards;
        }
        @keyframes cutCake {
            0% { transform: rotateY(0deg); box-shadow: 0 0 0 rgba(0, 0, 0, 0); }
            50% { transform: rotateY(180deg); box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.5); }
            100% { transform: rotateY(360deg); box-shadow: 0 0 0 rgba(0, 0, 0, 0); }
        }
        .cake-prompt {
            font-size: 24px;
            color: #3366cc;
            margin-top: 10px;
            animation: glow 2s infinite;
            font-weight: bold;
        }
        .firework {
            position: absolute;
            width: 10px;
            height: 10px;
            background: radial-gradient(circle, #ffcc66, transparent);
            border-radius: 50%;
            animation: firework 1s forwards;
            z-index: 3;
        }
        @keyframes firework {
            0% { transform: scale(0); opacity: 1; }
            100% { transform: scale(5); opacity: 0; }
        }
        .bg-firework {
            position: absolute;
            width: 8px;
            height: 8px;
            background: radial-gradient(circle, #ff99cc, transparent);
            border-radius: 50%;
            animation: bgFirework 1.5s forwards;
            z-index: 7;
        }
        @keyframes bgFirework {
            0% { transform: scale(0); opacity: 0.8; }
            100% { transform: scale(4); opacity: 0; }
        }
        .typewriter {
            display: inline-block;
            overflow: hidden;
            white-space: nowrap;
            border-right: 2px solid #333;
            animation: typing 2s steps(20, end), blink-caret 0.5s step-end infinite;
        }
        @keyframes typing {
            from { width: 0; }
            to { width: 100%; }
        }
        @keyframes blink-caret {
            from, to { border-color: transparent; }
            50% { border-color: #333; }
        }
        .main-content {
            display: none;
        }
        .main-content.show {
            display: block;
        }
        .mute-button {
            position: fixed;
            top: 10px;
            right: 10px;
            font-size: 24px;
            cursor: pointer;
            z-index: 100;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 50%;
            padding: 5px;
            border: 2px solid #3366cc;
        }
        .signature {
            font-size: 18px;
            color: #ff99cc;
            margin-top: 20px;
            display: none;
            position: relative;
            z-index: 2;
            animation: fadeIn 1s forwards, heartGlow 2s infinite;
            font-weight: bold;
        }
        .signature.show {
            display: block;
        }
        @keyframes heartGlow {
            0%, 100% { text-shadow: 0 0 5px #ff99cc; }
            50% { text-shadow: 0 0 15px #ff99cc; }
        }
    </style>
</head>
<body>
    <div class="intro-overlay" id="introOverlay">
        <div>Hi, ready for a surprise? Then tap!</div>
    </div>
    <div class="star-overlay" id="starOverlay">
        <span>Surbala, you're a star ‚≠ê</span>
    </div>
    <div class="final-overlay" id="finalOverlay">
        <div class="cake-container" id="cakeContainer">
            <div class="cake" id="cake">üéÇ</div>
            <div class="cake-prompt" id="cakePrompt">Tap to Cut the Cake!</div>
            <div class="dance-cat" id="danceCat1">üê±</div>
            <div class="dance-cat" id="danceCat2">üê±</div>
            <div class="dance-cat" id="danceCat3">üê±</div>
            <div class="falling-cat" id="fallingCat1">üê±</div>
            <div class="falling-cat" id="fallingCat2">üê±</div>
            <div class="falling-cat" id="fallingCat3">üê±</div>
            <div class="enjoy-message" id="enjoyMessage">Enjoy your day!!</div>
            <div class="signature" id="signatureMessage">Made with love for Gadhaüî•ü©∑ by Gadhaüî•ü©µ</div>
        </div>
    </div>
    <div class="mute-button" id="muteButton">üîä</div>
    <div class="main-content" id="mainContent">
        <div class="stars" id="starsContainer"></div>
        <div class="hearts" id="heartsContainer"></div>
        <div class="sky-sparkle left">‚ú®‚ú®</div>
        <div class="sky-sparkle right">‚ú®‚ú®</div>
        <div class="lights">
            <div></div><div></div><div></div><div></div><div></div>
        </div>
        <div class="banner">
            <span>H</span><span>A</span><span>P</span><span>P</span><span>Y</span>
            <span>B</span><span>I</span><span>R</span><span>T</span><span>H</span><span>D</span><span>A</span><span>Y</span>
        </div>
        <div class="star-message">Surbala, you're a star ‚≠ê</div>
        <div class="balloons" id="balloonsContainer">
            <div class="balloon" data-letters="I‚Äôve accepted where I went wrong and the past I regret. But not everything said about me was true,\n" data-final="I know"><span>S</span></div>
            <div class="balloon" data-letters="and not everything I did was out of bad intent. I just hope one day, you‚Äôll see that too.\n" data-final="things ended"><span>U</span></div>
            <div class="balloon" data-letters="not trying to defend, just needed to say it for peace. Wishing you the best, always. And yeah(yuhüî•üî•)\n" data-final="on a rough"><span>R</span></div>
            <div class="balloon" data-letters="Guess we aren‚Äôt talking anymore, but, you. You were one of the best people I ever had met. Happiest birthday to one of the most amazing and special one from my life.\n" data-final="note but yeah(yuhüî•)"><span>B</span></div>
            <div class="balloon" data-letters="May you have an amazing day today. hanubi olle hanubi If I ever made you feel like a loss, or hurt you unknowingly I‚Äôm really sorry. This message might be the last one, so please tolerate this one.\n" data-final="I'll always remember"><span>A</span></div>
            <div class="balloon" data-letters="One last thing I had always wished for. From then till now and always will! Wherever you go, whatever you do never lose that pretty smile on your face. gng,twin,gurl,gadha,yerum,thugokchaoüî•üî•üî• Once again, happy birthdayü´∂üèªüç∞\n" data-final="those valuable memories"><span>L</span></div>
            <div class="balloon" data-letters="And hyningba d mayam leiri ado skthu ro message se yam sangdok khre paragraph ga eye skthu pabu paramgadro khngde btw if it's the last then js know that you'll be missed alot and thanks again for making my life bloom \"Beautiful.lotus \"ü™∑ü©∑ You'll be an unforgettable one. Think my side of story ends here but yeah(yuhüî•) if you ever think of making a change in your decision then yeah (yuhüî•üî•üòÇüôÇ)you're always welcomed throughoutü©µ From Gadhaaaaüî• To Gadhaaaüî• To Gadhaaüî• To Gadha. Boring d khr oira malle bu cdü§¨ü§¨ü§¨" data-final="and the trust you once shared with me. Happy birthday gngü©∑"><span>A</span></div>
        </div>
        <div class="message" id="messageDiv">Tap on these balloons one by one to reveal a secret message!</div>
        <div class="hidden-message" id="hiddenMessage"></div>
        <div class="final-message" id="finalMessage"></div>
        <div class="wishing" id="wishingMessage">Wishing you the best! üéâ</div>
    </div>
    <audio id="bgm" loop>
        <source src="https://example.com/HappyBirthdayTune.mp3" type="audio/mp3">
        Your browser does not support the audio element.
    </audio>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <script>
        window.onload = function() {
            // Intro overlay
            const introOverlay = document.getElementById('introOverlay');
            const starOverlay = document.getElementById('starOverlay');
            const finalOverlay = document.getElementById('finalOverlay');
            const mainContent = document.getElementById('mainContent');
            const messageDiv = document.getElementById('messageDiv');
            const bgm = document.getElementById('bgm');
            const muteButton = document.getElementById('muteButton');
            let canInteractWithBalloons = false;

            // Audio control
            muteButton.addEventListener('click', () => {
                if (bgm.muted) {
                    bgm.muted = false;
                    muteButton.textContent = 'üîä';
                } else {
                    bgm.muted = true;
                    muteButton.textContent = 'üîá';
                }
            });

            const handleIntroInteraction = (e) => {
                e.preventDefault();
                introOverlay.classList.add('hidden');
                starOverlay.classList.add('show');
                setTimeout(() => {
                    starOverlay.classList.remove('show');
                    mainContent.classList.add('show');
                    messageDiv.classList.add('show');
                    canInteractWithBalloons = true;
                    bgm.play().catch(error => {
                        console.log("Autoplay failed:", error);
                    });
                }, 3000);
            };
            introOverlay.addEventListener('click', handleIntroInteraction);
            introOverlay.addEventListener('touchend', handleIntroInteraction);

            // Add stars to background
            const starsContainer = document.getElementById('starsContainer');
            function addStars() {
                const starsCount = 20;
                for (let i = 0; i < starsCount; i++) {
                    const star = document.createElement('div');
                    star.classList.add('star');
                    star.style.left = `${Math.random() * 100}%`;
                    star.style.top = `${Math.random() * 100}%`;
                    star.style.animationDelay = `${Math.random() * 3}s`;
                    starsContainer.appendChild(star);
                }
            }
            addStars();

            // Add floating hearts to background
            const heartsContainer = document.getElementById('heartsContainer');
            function addHearts() {
                const heartsCount = 5;
                for (let i = 0; i < heartsCount; i++) {
                    const heart = document.createElement('div');
                    heart.classList.add('heart');
                    heart.textContent = '‚ù§Ô∏è';
                    heart.style.left = `${Math.random() * 100}%`;
                    heart.style.animationDelay = `${Math.random() * 8}s`;
                    heartsContainer.appendChild(heart);
                }
            }
            addHearts();

            // Confetti effect with shapes
            function launchConfetti() {
                confetti({
                    particleCount: 50,
                    spread: 80,
                    origin: { y: 0.6 },
                    shapes: ['circle', 'square', 'triangle', 'heart'],
                    colors: ['#ff6666', '#66cc66', '#6666ff', '#ffcc66', '#ff99cc']
                });
            }
            setTimeout(() => {
                setInterval(launchConfetti, 6000);
            }, 5000);

            // Add sparkles around balloons
            const balloonsContainer = document.getElementById('balloonsContainer');
            function addSparkles() {
                const sparklesCount = 10;
                for (let i = 0; i < sparklesCount; i++) {
                    const sparkle = document.createElement('div');
                    sparkle.classList.add('sparkle');
                    sparkle.style.left = `${Math.random() * 100}%`;
                    sparkle.style.top = `${Math.random() * 100}%`;
                    sparkle.style.animationDelay = `${Math.random() * 1}s`;
                    balloonsContainer.appendChild(sparkle);
                }
            }
            addSparkles();

            // Add sparkles around cake when cut
            const cakeContainer = document.getElementById('cakeContainer');
            function addCakeSparkles() {
                const sparklesCount = 30;
                for (let i = 0; i < sparklesCount; i++) {
                    const sparkle = document.createElement('div');
                    sparkle.classList.add('sparkle');
                    sparkle.style.left = `${Math.random() * 100}%`;
                    sparkle.style.top = `${Math.random() * 100}%`;
                    sparkle.style.animationDelay = `${Math.random() * 1}s`;
                    cakeContainer.appendChild(sparkle);
                }
            }

            // Fireworks effect
            function launchFireworks() {
                const fireworksCount = 75;
                for (let i = 0; i < fireworksCount; i++) {
                    const firework = document.createElement('div');
                    firework.classList.add('firework');
                    firework.style.left = `${Math.random() * 100}%`;
                    firework.style.top = `${Math.random() * 100}%`;
                    firework.style.animationDelay = `${Math.random() * 2}s`;
                    document.body.appendChild(firework);
                }
            }
            function launchBigFireworks() {
                const fireworksCount = 150;
                for (let i = 0; i < fireworksCount; i++) {
                    const firework = document.createElement('div');
                    firework.classList.add('firework');
                    firework.style.left = `${Math.random() * 100}%`;
                    firework.style.top = `${Math.random() * 100}%`;
                    firework.style.animationDelay = `${Math.random() * 1}s`;
                    document.body.appendChild(firework);
                }
            }
            function continuousFireworks() {
                launchFireworks();
            }
            // Background fireworks for the black screen
            function backgroundFireworks() {
                const fireworksCount = 20;
                for (let i = 0; i < fireworksCount; i++) {
                    const firework = document.createElement('div');
                    firework.classList.add('bg-firework');
                    firework.style.left = `${Math.random() * 100}%`;
                    firework.style.top = `${Math.random() * 100}%`;
                    firework.style.animationDelay = `${Math.random() * 1.5}s`;
                    finalOverlay.appendChild(firework);
                }
            }

            // Balloon game
            const balloons = document.querySelectorAll('.balloon');
            const hiddenMessageDiv = document.getElementById('hiddenMessage');
            const finalMessageDiv = document.getElementById('finalMessage');
            const wishingMessageDiv = document.getElementById('wishingMessage');
            const cake = document.getElementById('cake');
            const cakePrompt = document.getElementById('cakePrompt');
            const danceCats = document.querySelectorAll('.dance-cat');
            const fallingCats = document.querySelectorAll('.falling-cat');
            const enjoyMessage = document.getElementById('enjoyMessage');
            const signatureMessage = document.getElementById('signatureMessage');
            let poppedCount = 0;
            const fullHiddenMessage = "I‚Äôve accepted where I went wrong and the past I regret. But not everything said about me was true,\nand not everything I did was out of bad intent. I just hope one day, you‚Äôll see that too.\nnot trying to defend, just needed to say it for peace. Wishing you the best, always. And yeah(yuhüî•üî•)\nGuess we aren‚Äôt talking anymore, but, you. You were one of the best people I ever had met. Happiest birthday to one of the most amazing and special one from my life.\nMay you have an amazing day today. hanubi olle hanubi If I ever made you feel like a loss, or hurt you unknowingly I‚Äôm really sorry. This message might be the last one, so please tolerate this one.\nOne last thing I had always wished for. From then till now and always will! Wherever you go, whatever you do never lose that pretty smile on your face. gng,twin,gurl,gadha,yerum,thugokchaoüî•üî•üî• Once again, happy birthdayü´∂üèªüç∞\nAnd hyningba d mayam leiri ado skthu ro message se yam sangdok khre paragraph ga eye skthu pabu paramgadro khngde btw if it's the last then js know that you'll be missed alot and thanks again for making my life bloom \"Beautiful.lotus \"ü™∑ü©∑ You'll be an unforgettable one. Think my side of story ends here but yeah(yuhüî•) if you ever think of making a change in your decision then yeah (yuhüî•üî•üòÇüôÇ)you're always welcomed throughoutü©µ From Gadhaaaaüî• To Gadhaaaüî• To Gadhaaüî• To Gadha. Boring d khr oira malle bu cdü§¨ü§¨ü§¨";
            let revealedMessage = [];
            let finalMessage = [];

            const messageChunks = fullHiddenMessage.split('\n');
            const chunkedMessages = Array.from(balloons).map((balloon, index) => ({
                letters: balloon.getAttribute('data-letters'),
                final: balloon.getAttribute('data-final')
            }));

            const popBalloon = (balloon, index) => {
                if (!canInteractWithBalloons) {
                    return;
                }
                if (!balloon.classList.contains('popped')) {
                    balloon.classList.add('popped');
                    poppedCount++;
                    const chunk = chunkedMessages[index];
                    revealedMessage.push(chunk.letters);
                    finalMessage.push(chunk.final);

                    hiddenMessageDiv.textContent = revealedMessage.join('');
                    finalMessageDiv.textContent = finalMessage.join(' ');
                    hiddenMessageDiv.classList.remove('typewriter');
                    void hiddenMessageDiv.offsetWidth;
                    hiddenMessageDiv.classList.add('show', 'typewriter');
                    finalMessageDiv.classList.add('show');
                    hiddenMessageDiv.scrollTop = hiddenMessageDiv.scrollHeight;
                    finalMessageDiv.scrollTop = finalMessageDiv.scrollHeight;

                    for (let i = 0; i < 5; i++) {
                        const burst = document.createElement('div');
                        burst.classList.add('burst');
                        burst.style.left = `${balloon.offsetLeft + 25}px`;
                        burst.style.top = `${balloon.offsetTop + 35}px`;
                        burst.style.transform = `translate(${Math.random() * 40 - 20}px, ${Math.random() * 40 - 20}px)`;
                        balloonsContainer.appendChild(burst);
                    }

                    if (poppedCount === balloons.length) {
                        hiddenMessageDiv.textContent = fullHiddenMessage;
                        hiddenMessageDiv.classList.remove('typewriter');
                        void hiddenMessageDiv.offsetWidth;
                        hiddenMessageDiv.classList.add('show', 'typewriter');
                        messageDiv.style.display = 'none';
                        wishingMessageDiv.classList.add('show');
                        // Wait for the typewriter animation to finish (2s) + 3s pause
                        setTimeout(() => {
                            finalOverlay.classList.add('show');
                            setTimeout(() => {
                                cakeContainer.classList.add('show');
                            }, 2000); // Show cake 2 seconds after black screen fade-in
                        }, 5000); // 2s for typewriter + 3s pause
                    }
                }
            };

            const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
            balloons.forEach((balloon, index) => {
                if (isTouchDevice) {
                    balloon.addEventListener('touchstart', (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        popBalloon(balloon, index);
                    });
                } else {
                    balloon.addEventListener('click', () => popBalloon(balloon, index));
                }
            });

            // Cake cutting interaction
            const handleCakeInteraction = (e) => {
                e.preventDefault();
                if (!cake.classList.contains('cut')) {
                    cake.classList.add('cut');
                    cake.textContent = 'üç∞';
                    cakePrompt.textContent = 'Surbala Cuts the Cake! Yeahhh Happy Sweet 17 üéâ';
                    launchBigFireworks();
                    continuousFireworks();
                    launchConfetti();
                    addCakeSparkles();
                    danceCats.forEach(cat => cat.classList.add('show'));
                    fallingCats.forEach(cat => cat.classList.add('show'));
                    setTimeout(() => {
                        enjoyMessage.classList.add('show');
                        signatureMessage.classList.add('show');
                        continuousFireworks();
                        // Start background fireworks
                        backgroundFireworks();
                        setInterval(backgroundFireworks, 2000);
                    }, 1000);
                }
            };
            cakeContainer.addEventListener('click', handleCakeInteraction);
            cakeContainer.addEventListener('touchstart', handleCakeInteraction);
        };
    </script>
</body>
</html>
